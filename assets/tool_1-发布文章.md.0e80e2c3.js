import{_ as s,o as a,c as n,U as o}from"./chunks/framework.fd3d4570.js";const e="/study/images/工具/1-new-repository.png",l="/study/images/工具/2-generate-new-token.png",p="/study/images/工具/3-select-repository-permission.png",t="/study/images/工具/4-set-token.png",m=JSON.parse('{"title":"Vitepress + Github Actions","description":"","frontmatter":{},"headers":[],"relativePath":"tool/1-发布文章.md","filePath":"tool/1-发布文章.md"}'),c={name:"tool/1-发布文章.md"},r=o('<h1 id="vitepress-github-actions" tabindex="-1">Vitepress + Github Actions <a class="header-anchor" href="#vitepress-github-actions" aria-label="Permalink to &quot;Vitepress + Github Actions&quot;">​</a></h1><h2 id="_1-新建-github-仓库-存放项目" tabindex="-1">1. 新建 <code>Github</code> 仓库，存放项目 <a class="header-anchor" href="#_1-新建-github-仓库-存放项目" aria-label="Permalink to &quot;1. 新建 `Github` 仓库，存放项目&quot;">​</a></h2><p><img src="'+e+'" alt="img"></p><div class="tip custom-block"><p class="custom-block-title">提示</p><p>仓库名会变成访问路径的一部分，例如仓库名为 <code>study</code>,路径则为 <a href="https://hgj0707.github.io/study/" target="_blank" rel="noreferrer"><code>https://hgj0707.github.io/study/</code></a></p></div><h2 id="_2-配置仓库-token" tabindex="-1">2. 配置仓库 <code>token</code> <a class="header-anchor" href="#_2-配置仓库-token" aria-label="Permalink to &quot;2. 配置仓库 `token`&quot;">​</a></h2><h3 id="_1-找到生成-token-位置" tabindex="-1">1. 找到生成 <code>token</code> 位置 : <a class="header-anchor" href="#_1-找到生成-token-位置" aria-label="Permalink to &quot;1. 找到生成 `token` 位置 :&quot;">​</a></h3><ul><li>点击 <code>github</code> 头像</li><li>点击 <code>settings</code></li><li>点击 <code>Developer settings</code></li><li>点击 <code>Personal Access Token</code></li><li>点击 <code>Fine-grained tokens</code></li><li>点击 <code>Generate new token</code></li></ul><p><img src="'+l+'" alt="img"></p><h3 id="_2-生成-token" tabindex="-1">2. 生成 <code>token</code> <a class="header-anchor" href="#_2-生成-token" aria-label="Permalink to &quot;2. 生成 `token`&quot;">​</a></h3><ul><li><code>token name</code> 随意</li><li><code>Expiration</code> 为 <code>token</code> 的过期时间，选择的久一点<div class="tip custom-block"><p class="custom-block-title">提示</p><p><code>token</code> 过期后，不能自动发布文章，需要再次更新<code>token</code></p></div></li><li><code>Repository access</code> 选择我们的项目仓库</li><li><code>Repository permissions</code> 选择相应的权限</li></ul><p><img src="'+p+'" alt="img"></p><ul><li>生成 <code>token</code>, 复制生成的 <code>token</code>，只会出现一次</li></ul><h3 id="_3-将-token-配置到仓库" tabindex="-1">3. 将 <code>token</code> 配置到仓库 <a class="header-anchor" href="#_3-将-token-配置到仓库" aria-label="Permalink to &quot;3. 将 `token` 配置到仓库&quot;">​</a></h3><ul><li>回到仓库的 <code>settings</code></li><li>点击 <code>Secrets and variables</code> 中的 <code>Acitons</code></li><li>点击 <code>New repository serect</code>, <code>name</code> 为 <code>ACCESS_TOKEN</code>, <code>serect</code> 为刚刚生成的 <code>token</code></li></ul><p><img src="'+t+`" alt="img"></p><h2 id="_3-使用-vitepress-构建项目" tabindex="-1">3. 使用 <code>Vitepress</code> 构建项目 <a class="header-anchor" href="#_3-使用-vitepress-构建项目" aria-label="Permalink to &quot;3. 使用 \`Vitepress\` 构建项目&quot;">​</a></h2><ol><li>拉取仓库到本地</li><li>参照 <a href="https://vitepress.dev/" target="_blank" rel="noreferrer"><code>vitepress</code> 文档</a> 构建项目</li></ol><h2 id="_4-编写-workflows-文件" tabindex="-1">4. 编写 <code>Workflows</code> 文件 <a class="header-anchor" href="#_4-编写-workflows-文件" aria-label="Permalink to &quot;4. 编写 \`Workflows\` 文件&quot;">​</a></h2><ol><li>在项目根目录新建 <code>.github</code> 文件夹</li><li>在 <code>.github</code> 文件夹内新建 <code>workflows</code> 文件夹</li><li>在 <code>workflows</code> 文件夹内新建 <code>docs.yml</code> 文件</li></ol><h3 id="docs-yml文件如下" tabindex="-1"><code>docs.yml</code>文件如下： <a class="header-anchor" href="#docs-yml文件如下" aria-label="Permalink to &quot;\`docs.yml\`文件如下：&quot;">​</a></h3><div class="language-yml"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># name 可以自定义</span></span>
<span class="line"><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deploy GitHub Pages</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 触发条件：在 push 到 main 分支后</span></span>
<span class="line"><span style="color:#FF9CAC;">on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">push</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">branches</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 任务</span></span>
<span class="line"><span style="color:#F07178;">jobs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">build-and-deploy</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;"># 服务器环境：最新版 Ubuntu</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">runs-on</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ubuntu-latest</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">steps</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;"># 拉取代码</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Checkout</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">uses</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">actions/checkout@v2</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">with</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">persist-credentials</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;"># 生成静态文件</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Build</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">run</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm install &amp;&amp; npm run docs:build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;"># 部署到 GitHub Pages</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Deploy</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">uses</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">JamesIves/github-pages-deploy-action@releases/v3</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">with</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;"># 刚才生成的 secret</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">ACCESS_TOKEN</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">\${{ secrets.ACCESS_TOKEN }}</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;"># 部署到 gh-pages 分支，main 分支存放源码，gh-pages 分支存放生成的静态文件</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">BRANCH</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gh-pages</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;font-style:italic;"># vitepress 生成的静态文件存放的地方</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">FOLDER</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docs/.vitepress/dist</span></span></code></pre></div><ol start="4"><li>提交代码到仓库，即可自动发布</li></ol>`,22),i=[r];function d(y,D,C,F,h,A){return a(),n("div",null,i)}const _=s(c,[["render",d]]);export{m as __pageData,_ as default};
